-- –¢–≤–æ—Ä—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –§–∏—Ç–Ω–µ—Å—Å –∫–ª—É–±
-- –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã:
-- üü£ –£—á–µ—Ç–∞ —Ç—Ä–µ–Ω–µ—Ä–æ–≤ Trainer
-- üü£ –£—á–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ Clients
-- üü£ –£—á–µ—Ç–∞ —Ñ–∏—Ç–Ω–µ—Å—Å –ø—Ä–æ–≥—Ä–∞–º–º Fitness

-- –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É Timetable —Å–æ —Å–≤—è–∑—å—é "–ú–Ω–æ–≥–∏–µ –∫–æ –ú–Ω–æ–≥–∏–º", –≤  –Ω–µ–π –±—É–¥–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ, –∫–∞–∫–æ–π —Ç—Ä–µ–Ω–µ—Ä –±—É–¥–µ—Ç –ø—Ä–æ–≤–æ–¥–∏—Ç—å, –∏ –¥–∞—Ç–∞ –∑–∞–Ω—è—Ç–∏—è
-- –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É Abonnement —Å–æ —Å–≤—è–∑—å—é "–ú–Ω–æ–≥–∏–µ –∫–æ –ú–Ω–æ–≥–∏–º", –≤  –Ω–µ–π –±—É–¥–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ –∏ –Ω–∞ –∫–∞–∫—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –æ–Ω –∑–∞–ø–∏—Å–∞–Ω  –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

-- –ù–∞–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã:
--–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —Ç—Ä–µ–Ω—Ä–æ–≤–æ–∫ 
--–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ —É –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
--–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–µ 45
--–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–∞—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –µ—â–µ –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
--–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –µ—â–µ –Ω–µ –∑–∞–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
--–ü–æ–ª—É—á–∏—Ç—å –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –Ω–∞ –∫–∞–∂–¥–æ–≥–æ —Ç—Ä–µ–Ω–µ—Ä–∞
--–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –≤–µ–¥—É—â–µ–≥–æ —Ç—Ä–µ–Ω–µ—Ä–∞ –∏ —É—á–∞–≤—Å—Ç–≤—É—é—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
--–ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∑–∞–ø–∏—Å–∞–≤—à–∏—Ö—Å—è –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ 2024 - 03 - 12
--–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
--–ü–æ–ª—É—á–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞  —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ—Å–µ—â–µ–Ω–∏–π

CREATE TABLE IF NOT EXISTS Trainer
(
  id_trainer INTEGER PRIMARY KEY AUTOINCREMENT,
  name_trainer TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS  Fitness
(
  id_fitness INTEGER PRIMARY KEY AUTOINCREMENT,
  title_fitness TEXT NOT NULL,
  duration INTEGER NOT NULL
);

CREATE TABLE IF NOT EXISTS  Timetable
(
  id_timetable INTEGER PRIMARY KEY AUTOINCREMENT,
  date_fitness DATE,
  fitness INTEGER DEFAULT NULL,
  trainer INTEGER DEFAULT NULL,
  FOREIGN KEY (fitness) REFERENCES Fitness(id_fitness),
  FOREIGN KEY (trainer) REFERENCES Trainer(id_trainer)
);

CREATE TABLE IF NOT EXISTS  Clients
(
  id_client INTEGER PRIMARY KEY AUTOINCREMENT,
  name_client TEXT NOT NULL
);

CREATE TABLE  IF NOT EXISTS  Abonnement
(
  timetable INTEGER DEFAULT NULL,
  client INTEGER NOT NULL,
  FOREIGN KEY (timetable) REFERENCES Timetable(id_timetable),
  FOREIGN KEY (client) REFERENCES Clients(id_client)
);

INSERT INTO Trainer (name_trainer) VALUES 
('Hange Zoe'),
('Erwin Smith'),
('Levi Ackermann');

INSERT INTO Fitness (title_fitness, duration) VALUES 
('Yoga', 60),
('Pilates', 45),
('Circuit Training', 60);

INSERT INTO Timetable (date_fitness, fitness, trainer) VALUES 
('2024-03-11', 1, 1),
('2024-03-12', 1, 1),
('2024-03-12', 2, 2),
('2024-03-12', 3, 3),
('2024-03-13', 2, 3),
('2024-03-13', 3, 2),
('2024-03-14', 3, NULL),
('2024-03-15', NULL, NULL);
 
INSERT INTO Clients (name_client) VALUES 
('Sasha Braus'),
('Rainer Braun'),
('Mikasa Ackermann'),
('Eren Jaeger'),
('Armin Arlert'),
('Annie Leonhart');

INSERT INTO Abonnement (client, timetable) VALUES
(1, 1),
(2, 2),
(3, 3),
(4, 4),
(3, 5),
(5, 6),
(6, NULL),
(4, 3);


--–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —Ç—Ä–µ–Ω—Ä–æ–≤–æ–∫ 
SELECT * FROM Timetable

--–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ —É –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
SELECT Clients.name_client as "–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞", Fitness.title_fitness  as "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏", Timetable.date_fitness as "–î–∞—Ç–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏" FROM Abonnement
JOIN Clients ON client = Clients.id_client
JOIN Timetable ON timetable = Timetable.id_timetable
JOIN Fitness ON fitness = Fitness.id_fitness

--–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∏  –¥–∞—Ç—É, —Å –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–º —Ç—Ä–µ–Ω–µ—Ä–æ–º –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –±–æ–ª—å—à–µ 45
SELECT date_fitness as "–î–∞—Ç–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏", trainer as "–ò–º—è —Ç—Ä–µ–Ω–µ—Ä–∞", title_fitness  as "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏", duration as "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å" FROM Timetable
JOIN Fitness ON fitness = Fitness.id_fitness
WHERE duration > 45 and trainer IS NOT NULL

--–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–∞—Ç —Å NULL –µ—Å–ª–∏ —É –Ω–∏—Ö –µ—â–µ –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –∏–ª–∏ —Ç—Ä–µ–Ω–µ—Ä.
SELECT date_fitness as "–î–∞—Ç–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏", name_trainer as "–ò–º—è —Ç—Ä–µ–Ω–µ—Ä–∞", title_fitness  as "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏" FROM Timetable
LEFT JOIN Trainer ON trainer = Trainer.id_trainer
LEFT JOIN Fitness ON fitness = Fitness.id_fitness
WHERE fitness IS NULL OR trainer IS NULL

--–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –µ—â–µ –Ω–µ –∑–∞–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
SELECT name_client as "–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞" FROM Abonnement
LEFT JOIN Clients ON client = Clients.id_client
WHERE timetable IS NULL

--–ü–æ–ª—É—á–∏—Ç—å –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –Ω–∞ –∫–∞–∂–¥–æ–≥–æ —Ç—Ä–µ–Ω–µ—Ä–∞
SELECT COUNT(fitness) as "–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫", name_trainer as "–ò–º—è —Ç—Ä–µ–Ω–µ—Ä–∞" FROM Timetable
JOIN Trainer ON trainer = Trainer.id_trainer
GROUP BY trainer

--–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –≤–µ–¥—É—â–µ–≥–æ —Ç—Ä–µ–Ω–µ—Ä–∞ –∏ —É—á–∞–≤—Å—Ç–≤—É—é—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
SELECT date_fitness as "–î–∞—Ç–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏", title_fitness as "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏", name_trainer as "–ò–º—è —Ç—Ä–µ–Ω–µ—Ä–∞", name_client as "–ó–∞–ø–∏—Å–∞–≤—à–∏–µ—Å—è –∫–ª–∏–µ–Ω—Ç—ã" FROM Abonnement
JOIN Clients ON client = Clients.id_client
JOIN Timetable ON timetable = Timetable.id_timetable
JOIN Trainer ON trainer = Trainer.id_trainer
JOIN Fitness ON fitness = Fitness.id_fitness
ORDER BY name_client ASC

--–ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∑–∞–ø–∏—Å–∞–≤—à–∏—Ö—Å—è –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ 2024-03-12
SELECT COUNT(client) as "–ó–∞–ø–∏—Å–∞–≤—à–∏–µ—Å—è –∫–ª–∏–µ–Ω—Ç—ã", date_fitness as "–î–∞—Ç–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏" FROM Abonnement
JOIN Timetable ON timetable = Timetable.id_timetable
WHERE date_fitness = "2024-03-12"

--–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
SELECT COUNT(id_client) as "–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–∞–≤—à–∏—Ö—Å—è –∫–ª–∏–µ–Ω—Ç–æ–≤", title_fitness as "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏" FROM Abonnement
JOIN Timetable ON timetable = Timetable.id_timetable
JOIN Clients ON client = Clients.id_client
JOIN Fitness ON fitness = Fitness.id_fitness
GROUP BY title_fitness

--–ü–æ–ª—É—á–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞  —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ—Å–µ—â–µ–Ω–∏–π
SELECT name_client  as "–ò–º—è –∫–ª–∏–µ–Ω—Ça", COUNT(timetable) as "–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫" FROM Abonnement
JOIN Clients ON client = Clients.id_client
GROUP BY name_client
ORDER BY COUNT(timetable)  DESC LIMIT 2

